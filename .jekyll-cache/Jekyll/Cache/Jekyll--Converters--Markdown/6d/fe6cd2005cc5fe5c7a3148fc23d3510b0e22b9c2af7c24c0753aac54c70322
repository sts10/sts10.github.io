I"Â;<p>This past week someone gained access to the PayPal account a mobile applications developer named Justin Williams.</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Someone socially engineered AT&amp;T to get a new SIM for my phone, signed into my Paypal (using 2FA) and withdrew a bunch of money.<br /><br />I am livid</p>&mdash; Justin Williams (@justin) <a href="https://twitter.com/justin/status/883171036283285508">July 7, 2017</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>He later <a href="https://carpeaqua.com/2017/07/07/hack-the-planet/">wrote a blog post about it</a>. He begins:</p>

<blockquote>
  <p>I like to think I take an above average amount of steps to secure myself online: I use a password manager, unique passwords as complex as the site will allow, and turn on 2-factor authentication when possible. A true security expert will likely find some sort of flaw in my setup, but I‚Äôll argue that I am doing more than 95% of the planet.</p>
</blockquote>

<blockquote>
  <p>So how did I, someone who is reasonably secure, have his cell phone disabled, his PayPal account compromised, and a few hundred dollars withdrawn from his bank account?</p>
</blockquote>

<p>It sounds like what happened is an attacker got AT&amp;T to port his phone number to the attacker‚Äôs phone. Then the attacker reset Williams‚Äô PayPal password via an SMS recovery.</p>

<blockquote>
  <p>You‚Äôre likely wondering how my cell phone being compromised leads to my PayPal account being compromised? All you need to reset a PayPal password is an email address and a phone number to accept the verification code.</p>
</blockquote>

<p>Williams is seemingly right when he notes that PayPal‚Äôs SMS 2-factor authentication is useless in this case, since that confirmation messages also goes to his phone, which in this case the attackers already have access to. Also note that his complex PayPal password stored in a password manager was of no help‚Äì the attacker simply reset it.</p>

<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr">You only need SMS to reset a paypal password. It&#39;s comically insecure.</p>&mdash; Justin Williams (@justin) <a href="https://twitter.com/justin/status/883697835689902080">July 8, 2017</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>(This story reminds me a bit of what happened to Cody Brown in May: <a href="https://medium.com/@CodyBrown/how-to-lose-8k-worth-of-bitcoin-in-15-minutes-with-verizon-and-coinbase-com-ba75fb8d0bac">‚ÄúHow to lose $8k worth of bitcoin in 15 minutes with Verizon and Coinbase.com‚Äù</a>; and, of course, <a href="https://www.wired.com/2012/08/apple-amazon-mat-honan-hacking/">Mat Honan‚Äôs hacking in 2012</a>.)</p>

<h2 id="is-the-fault-with-paypal-or-att">Is the fault with PayPal or AT&amp;T?</h2>

<p>In concluding his blog post, Williams writes:</p>

<blockquote>
  <p>I don‚Äôt even place blame on PayPal for this directly. The fault lies with the AT&amp;T call center representative who let someone manipulate my account without knowing my passcode. I‚Äôve been told this is being escalated internally, but I haven‚Äôt heard anything from corporate channels, so I remain skeptical until I see or hear something.</p>
</blockquote>

<p>That makes sense to me, but even so, I think PayPal should have a way to opt out of the ability SMS password reset. And ideally you could do that and still have 2-factor authentication, even if just via SMS.</p>

<p>In general I don‚Äôt think phone numbers should be considered identification. AT&amp;T‚Äôs security doesn‚Äôt seem to be built for it, as Williams‚Äô story shows: he had set up a passcode with AT&amp;T and it only slowed the attackers down for a few hours.</p>

<h2 id="the-difference-between-sms-as-a-2nd-factor-and-sms-password-recovery">The Difference Between SMS as a 2nd Factor and SMS Password Recovery</h2>

<p>One important thing I‚Äôm starting to understand is that there is a difference between using SMS as a second factor for login and having SMS as a password reset option.</p>

<p>Williams writes under a sub heading ‚ÄúLessons Learned?‚Äù</p>

<blockquote>
  <p>I have spent the morning trying to evaluate my security practices and there‚Äôs not much I can think about that I‚Äôd do otherwise. Twitter tells me I shouldn‚Äôt use SMS-based 2 factor authentication and should use app-based 2 factor instead. I agree! The problem is that some sites like PayPal don‚Äôt offer the better security. The alternative is to just go back to single factor, which I am not so sure is the best solution either.</p>
</blockquote>

<p>My guess is that once you give PayPal a phone number, it enables SMS password recovery automatically. Maybe you gave PayPal your phone number for the first time when you enabled SMS two factor authentication, but even if that were the case, I think it‚Äôs wrong to conflate SMS password reset with SMS as a 2nd factor for login. (In my case, PayPal had my phone number before I enabled SMS 2-factor.)</p>

<h3 id="another-example-google">Another Example: Google</h3>

<p>Note that Google/Gmail also automatically sets up SMS password recovery. I‚Äôm not sure if it does it when you enable 2-factor, or when you add a phone number by some other method, but when I checked, I indeed had SMS password recovery enabled on my Google account.</p>

<p>I only knew (a) that it was likely turned on and (b) to turn it off because I spotted this tweet from my friend Dan last month:</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">This‚Äîand turn off SMS recovery for your Gmail account. <a href="https://t.co/sCzjfgEsyW">https://t.co/sCzjfgEsyW</a></p>&mdash; Dan Romero (@dwr) <a href="https://twitter.com/dwr/status/871737650457133058">June 5, 2017</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Even then, last month, I knew to quickly disabled this (I explain how I did this below).</p>

<p>A lot of people disparage SMS as a second factor for login, and the fact that it‚Äôs pretty easy to attack shows that, but I‚Äôm not sure it‚Äôs fair to blame it for attacks that exploit SMS password reset. These two settings can (and maybe should) be totally separate‚Äì I‚Äôm pretty sure Google could leave SMS password recover as an option but have it turned off by default.</p>

<h4 id="how-to-remove-sms-password-recovery-for-your-google-account">How to remove SMS password recovery for your Google account</h4>

<p>First, go to <a href="https://myaccount.google.com/security#signin">the ‚ÄúSigning in‚Äù section of Google‚Äôs security page</a>. Scroll down a bit to the section titled ‚ÄúAccount recovery options‚Äù. Now remove the ‚ÄúRecovery phone‚Äù option.</p>

<p><img src="/img/no-recovery-options.jpg" alt="No recovery options" />
<!-- <img src="https://pbs.twimg.com/media/DBkNOsMVoAAod2x.jpg"> --></p>

<p>It‚Äôs your call as to whether to leave a recovery email in place‚Äì I chose not to. (The recovery email for Honan‚Äôs Gmail account plays a key part of <a href="https://www.wired.com/2012/08/apple-amazon-mat-honan-hacking/">his story</a>.)</p>

<p>I vaguely remember that either Facebook or Twitter enabled SMS password recovery, but I can‚Äôt find proof of that in either of the settings.</p>

<h2 id="back-to-paypal-some-investigation">Back to PayPal: Some Investigation</h2>

<p>As I mentioned, I already have my cell phone number tied to my PayPal account. To confirm what Williams wrote, I successfully reset my PayPal password using just my email address and access to my cell phone. Creepy!</p>

<p><img src="/img/sms-reset/enter-email.png" alt="enter your email" /></p>

<p><img src="/img/sms-reset/confirm-its-you.png" alt="confirm it's you" /></p>

<p><img src="/img/sms-reset/type-in-code.png" alt="type in code" /></p>

<p><img src="/img/sms-reset/choose-new-password.png" alt="choose new password" /></p>

<p><img src="/img/sms-reset/all-set.png" alt="all set OR AM I?" /></p>

<p>Again, the issue here is that these two things‚Äì my email address (not access to it, just knowledge of the address) and access to my SMS messages‚Äì are not very hard to get a hold of.</p>

<p>I see two possible solutions to this issue‚Äì ideally I‚Äôd find some setting in PayPal‚Äôs security page similar to Google‚Äôs that allows me to disable SMS password recovery.</p>

<p>The second and less ideal solution would be to simply remove my cell phone from my PayPal account. This is a worse solution because (a) I would then not be able to use SMS 2-factor authentication and (b) PayPal would be unable to alert me of new logins and other  potentially suspicious activity via text message. But I figure my random password is more secure that my phone number, so I think I‚Äôd go for it if given the option.</p>

<p>I couldn‚Äôt figure out how to do either of these things on my own. So I took to Twitter and asked @AskPayPal if either of these solutions were possible (maybe I was missing something).</p>

<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/AskPayPal">@AskPayPal</a> is there a way to remove the SMS recovery option? Is there a way to remove my phone number from my account completely?</p>&mdash; Sam Schlinkert (@sts10) <a href="https://twitter.com/sts10/status/883702010570313728">July 8, 2017</a></blockquote>
<script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Their initial response seems to be incorrect:</p>

<blockquote>
  <p>Great question! You should be able to remove the phone number and SMS by clicking settings and edit next to the mobile number and uncheck appropriate boxes.</p>
</blockquote>

<p>I think the support person was referring to these two checkboxes in PayPal settings:</p>

<p><img src="/img/no-alert-checkboxes.jpg" alt="no alerts" /></p>

<p>But even with these unchecked I was again able to reset my PayPal password via SMS.</p>

<p>We then took to things to DMs.</p>

<p>Me: ‚ÄúAs I wrote in a series of tweets, I‚Äôm trying to ensure that an attacker CANNOT reset my password with my only my phone number. What steps can I take to ensure that happens?‚Äù</p>

<p>Them:</p>

<blockquote>
  <p>Your PayPal account is more secure with a phone number registered to the account. Keep in mind that you are 100% covered for any unauthorized activity that may occur. I recommend reaching out to your service provider with your concerns and to inquire about steps to safeguard the security of your mobile phone. ^LJ</p>
</blockquote>

<p>This first answer claimed three things: (a) that my account was more secure with a phone number attached (dubious, considering the Williams story), (b) told me I‚Äôm covered for unauthorized activity, and (c) told me this is more of a concern for my service provider than for PayPal (which I understand the logic of, but wasn‚Äôt wholly satisfactory).</p>

<p>In subsequent DMs the support person claimed ‚ÄúYou can remove the phone number from the PayPal account,‚Äù but I sent screenshots showing there was only a way to add a new number or edit my current number. Eventually he or she threw me their 1-800 support phone number.</p>

<p>On the phone, I first asked if there was a way to remove my phone number from my account. A nice woman informed me that there had to be a phone number attached to my account, and that there was no way to remove it.</p>

<p>I then attempted to describe the attack on Williams and ask if there was a way for me to disable password reset by SMS. She said no, but did seem to imply that in some cases PayPal will asks security questions if a password reset request seems strange‚Äì as in it‚Äôs coming from a strange location. I‚Äôm not sure if she was referring to the security questions I set in the settings of my account or other questions from public record.</p>

<h2 id="what-to-do">What to Do</h2>

<p>It seems like the best solution, in addition to enabling 2 factor authentication via SMS for PayPal logins (which doesn‚Äôt defend against the attack on Williams, but hey, they have my phone number anyway), is for me to call my service provider and ask them for some increased security against this kind of attack. Though, as mentioned, Williams had a passcode set up with AT&amp;T and it didn‚Äôt do a whole lot of good, but I suppose it‚Äôs better than not having it.</p>

<p>One creative solution would be to switch the number PayPal has for me to a Google Voice number, on the bet that SMS messages to that number would be more difficult to intercept. I don‚Äôt know enough about Google Voice to know this though. The other more radical solution would be to delete my PayPal account and attempt to create a new one without a phone number attached to it, but from what they said on the phone that seems impossible.</p>

<p>Beyond PayPal, I‚Äôm going to be on the lookout for the ability to disable SMS password reset on all of my online accounts going forward, especially if that reset bypasses any and all forms of two factor authentication I may have set up. I also can see now how clicking the ‚ÄúI forget my password‚Äù link next to various login screens would give me a good clue as to what recovery options that particular service offers.</p>

<p>I‚Äôm sure SMS password reset has saved some people‚Äôs bacon in some cases, but disabling it seems to be an important step toward greater security after (1) enabling the best form of two-factor authentication and (2) using unique, random passwords for all your accounts. I‚Äôd almost say we need a site like <a href="https://twofactorauth.org/">Two Factor  Auth</a> but that shows sites and services where users may have SMS password reset on without knowing it, and with instructions on how to turn it off (if possible).</p>

<h2 id="update-a-decent-solution">Update: A Decent Solution</h2>

<p>Taking advice from <a href="https://motherboard.vice.com/en_us/article/zm8a9y/how-to-protect-yourself-from-sim-swapping-hacks">this article</a>, I ended up creating and using a Google Voice number to help mitigate these issues.</p>

<h2 id="epilogue-beyond-2-factor">Epilogue: Beyond 2-Factor?</h2>

<p>Today Russel Brandom wrote <a href="https://www.theverge.com/2017/7/10/15946642/two-factor-authentication-online-security-mess">an article</a> for The Verge talking about what a mess two-factor authentication is currently. It reflects a bit of the hopelessness and resignation I express above:</p>

<blockquote>
  <p>None of this means two-factor is pointless, but it isn‚Äôt the silver bullet that it seemed to be in 2012. Adding an authentication code hardens the login page, but smart attackers will just find another angle of approach, whether it‚Äôs a carrier account, a preregistered device, or just a customer service department that‚Äôs a little too eager to reset the password. Those weak points are the real measure of how secure an account is, but they‚Äôre impossible to spot from the outside. The result is that, if you‚Äôre looking for the chat app that‚Äôs hardest to hijack, it‚Äôs hard for even sophisticated users to know what to look for.</p>
</blockquote>

<p>So we beat on, boats against the current, etc.</p>
:ET